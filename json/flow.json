function step(){switch(current-1>target||target>current+1){case!0:moveTo(current+(target-current)/3),window.setTimeout(step,50),timer=1;break;default:timer=0}}function glideTo(e,i){target=e,mem_target=e,0==timer&&(window.setTimeout(step,50),timer=1),caption_id=i,caption=img_div.childNodes.item(array_images[caption_id]).getAttribute("alt"),""==caption&&(caption="&nbsp;"),caption_div.innerHTML=caption,0==dragging&&(new_slider_pos=scrollbar_width*-(100*e/((max-1)*xstep))/100-new_posx,slider_div.style.marginLeft=new_slider_pos-conf_slider_width+"px")}function moveTo(e){current=e;for(var i=max,t=0;t<max;t++){var o=img_div.childNodes.item(array_images[t]),n=t*-xstep;if(n+max_conf_focus<mem_target||n-max_conf_focus>mem_target)o.style.visibility="hidden",o.style.display="none";else{var s=Math.sqrt(1e4+e*e)+100,a=e/s*size+size;o.style.display="block";var d=o.h/o.w*o.pc/s*size;switch(d>max_height){case!1:var r=o.pc/s*size;break;default:d=max_height;var r=o.w*d/o.h}var l=.34*images_width-d+images_top+d/(conf_reflection_p+1)*conf_reflection_p;switch(o.style.left=a-o.pc/2/s*size+images_left+"px",r&&d&&(o.style.height=d+"px",o.style.width=r+"px",o.style.top=l+"px"),o.style.visibility="visible",0>e){case!0:i++;break;default:i-=1}switch(o.i==caption_id){case!1:o.onclick=function(){glideTo(this.x_pos,this.i)};break;default:i+=1,o.onclick=function(){document.location=this.url}}o.style.zIndex=i}e+=xstep}}function refresh(e){imageflow_div=document.getElementById(conf_imageflow),img_div=document.getElementById(conf_images),scrollbar_div=document.getElementById(conf_scrollbar),slider_div=document.getElementById(conf_slider),caption_div=document.getElementById(conf_captions),images_width=img_div.offsetWidth,images_top=imageflow_div.offsetTop,images_left=imageflow_div.offsetLeft,max_conf_focus=conf_focus*xstep,size=.5*images_width,scrollbar_width=.6*images_width,conf_slider_width=.5*conf_slider_width,max_height=.51*images_width,imageflow_div.style.height=max_height+"px",img_div.style.height=.338*images_width+"px",caption_div.style.width=images_width+"px",caption_div.style.marginTop=.03*images_width+"px",scrollbar_div.style.marginTop=.02*images_width+"px",scrollbar_div.style.marginLeft=.2*images_width+"px",scrollbar_div.style.width=scrollbar_width+"px",slider_div.onmousedown=function(){dragstart(this)},slider_div.style.cursor=conf_slider_cursor,max=img_div.childNodes.length;for(var i=0,t=0;t<max;t++){var o=img_div.childNodes.item(t);if(1==o.nodeType){switch(array_images[i]=t,o.onclick=function(){glideTo(this.x_pos,this.i)},o.x_pos=-i*xstep,o.i=i,1==e&&(o.w=o.width,o.h=o.height),o.w+1>o.h/(conf_reflection_p+1)){case!0:o.pc=118;break;default:o.pc=100}o.url=o.getAttribute("longdesc"),o.ondblclick=function(){document.location=this.url},o.style.cursor=conf_images_cursor,i++}}max=array_images.length,moveTo(current),glideTo(current,caption_id)}function show(e){var i=document.getElementById(e);i.style.visibility="visible"}function hide(e){var i=document.getElementById(e);i.style.visibility="hidden",i.style.display="none"}function handle(e){var i=!1;switch(e>0){case!0:caption_id>=1&&(target+=xstep,new_caption_id=caption_id-1,i=!0);break;default:caption_id<max-1&&(target-=xstep,new_caption_id=caption_id+1,i=!0)}1==i&&glideTo(target,new_caption_id)}function wheel(e){var i=0;e||(e=window.event),e.wheelDelta?i=e.wheelDelta/120:e.detail&&(i=-e.detail/3),i&&handle(i),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function initMouseWheel(){window.addEventListener&&imageflow_div.addEventListener("DOMMouseScroll",wheel,!1),imageflow_div.onmousewheel=wheel}function dragstart(e){dragobject=e,dragx=posx-dragobject.offsetLeft+new_slider_pos}function dragstop(){dragobject=null,dragging=!1}function drag(e){if(posx=document.all?window.event.clientX:e.pageX,null!=dragobject){dragging=!0,new_posx=posx-dragx+conf_slider_width,-new_slider_pos>new_posx&&(new_posx=-new_slider_pos),new_posx>scrollbar_width-new_slider_pos&&(new_posx=scrollbar_width-new_slider_pos);var i=new_posx+new_slider_pos,t=i/(scrollbar_width/(max-1)),o=Math.round(t),n=o*-xstep,s=o;dragobject.style.left=new_posx+"px",glideTo(n,s)}}function initMouseDrag(){document.onmousemove=drag,document.onmouseup=dragstop,document.onselectstart=function(){return 1==dragging?!1:!0}}function getKeyCode(e){return e=e||window.event,e.keyCode}var conf_reflection_p=.5,conf_focus=4,conf_slider_width=14,conf_images_cursor="pointer",conf_slider_cursor="default",conf_imageflow="imageflow",conf_loading="loading",conf_images="images",conf_captions="captions",conf_scrollbar="scrollbar",conf_slider="slider",caption_id=0,new_caption_id=0,current=0,target=0,mem_target=0,timer=0,array_images=new Array,new_slider_pos=0,dragging=!1,dragobject=null,dragx=0,posx=0,new_posx=0,xstep=150;window.onload=function(){document.getElementById(conf_imageflow)&&(hide(conf_loading),refresh(!0),show(conf_images),show(conf_scrollbar),initMouseWheel(),initMouseDrag())},window.onresize=function(){document.getElementById(conf_imageflow)&&refresh()},window.onunload=function(){document=null},document.onkeydown=function(e){var i=getKeyCode(e);switch(i){case 39:handle(-1);break;case 37:handle(1)}};
